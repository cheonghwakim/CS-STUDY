### í”„ë¡œì„¸ìŠ¤ ë™ê¸°í™” & ìƒí˜¸ë°°ì œ

#### Process Synchronization (ë™ê¸°í™”)

##### ë‹¤ì¤‘ í”„ë¡œê·¸ë˜ë° ì‹œìŠ¤í…œ

- ì¼ìƒì˜ ë§ì€ í”„ë¡œê·¸ë¨ì—ëŠ” ì—¬ëŸ¬ ê°œì˜ í”„ë¡œì„¸ìŠ¤ë“¤ì´ ì¡´ì¬
- í”„ë¡œì„¸ìŠ¤ë“¤ì€ ì„œë¡œ ë…ë¦½ì ìœ¼ë¡œ ë™ì‘ => ë™ì‹œì—! 
- ì´ëŸ° í™˜ê²½ì—ì„œ ì–´ë–¤ ìì› í•˜ë‚˜ë¥¼ Aì™€ Bê°€ ë™ì‹œì— ì‚¬ìš©í•œë‹¤? ë¬¸ì œê°€ ìƒê¸¸ ê°€ëŠ¥ì„± ì¡´ì¬

=> í•´ê²° ìœ„í•´ ëŒ€í™”ë¥¼ ë‚˜ëˆ ì•¼ í•¨. / ìì›ì˜ ì–´ëŠ ë¶€ë¶„ì„, ì–¸ì œ ì‚¬ìš©í•  ê²ƒì¸ì§€



##### ë™ê¸°í™”

- í”„ë¡œì„¸ìŠ¤ë“¤ì´ ì„œë¡œ ë™ì‘ì„ ë§ì¶”ëŠ” ê²ƒ
- í”„ë¡œì„¸ìŠ¤ë“¤ì´ ì„œë¡œ ì •ë³´ë¥¼ ê³µìœ í•˜ëŠ” ê²ƒ



### 1. ì€í–‰ ê³„ì¢Œ ë¬¸ì œ

```java
class Test {
	public static void main(String[] args) throws InterruptedException {
		BankAccount b = new BankAccount();
		Parent p = new Parent(b);
		Child c = new Child(b);
		p.start();   // start(): ì“°ë ˆë“œë¥¼ ì‹¤í–‰í•˜ëŠ” ë©”ì„œë“œ
		c.start();
		p.join();    // join(): ì“°ë ˆë“œê°€ ëë‚˜ê¸°ë¥¼ ê¸°ë‹¤ë¦¬ëŠ” ë©”ì„œë“œ
		c.join();
		System.out.println("balance = " + b.getBalance());
	}
}

// ê³„ì¢Œ
class BankAccount {
	int balance;
	void deposit(int amount) {
		balance = balance + amount;
	}
	void withdraw(int amount) {
		balance = balance - amount;
	}
	int getBalance() {
		return balance;
	}
}

// ì…ê¸ˆ í”„ë¡œì„¸ìŠ¤
class Parent extends Thread {
	BankAccount b;
	Parent(BankAccount b) {
		this.b = b;
	}
	public void run() {   // run(): ì“°ë ˆë“œê°€ ì‹¤ì œë¡œ ë™ì‘í•˜ëŠ” ë¶€ë¶„(ì¹˜í™˜)
		for (int i = 0; i < 100; i++)
		  b.deposit(1000);
	}
}

// ì¶œê¸ˆ í”„ë¡œì„¸ìŠ¤
class Child extends Thread {
	BankAccount b;
	Child(BankAccount b) {
		this.b = b;
	}
	public void run() {
		for (int i = 0; i < 100; i++)
		  b.withdraw(1000);
	}
}
```

ê²°ê³¼

```java
balance = 0
```



ì—¬ê¸°ì— ì•½ê°„ì˜ **ì‹œê°„ ì§€ì—°**ì„ ì‹œí‚¤ë©´,

```java
// ê³„ì¢Œ
class BankAccount {
	int balance;
	void deposit(int amount) {
		int temp = balance + amount;
		System.out.print("+");
		balance = temp;
	}
	void withdraw(int amount) {
		int temp = balance - amount;
		System.out.print("-");
		balance = temp;
	}
	int getBalance() {
		return balance;
	}
}
```

(ì¶œëŸ­, ë³€ìˆ˜ ëŒ€ì… ë™ì‘ ì¶”ê°€)

ê²°ê³¼

```java
++++++++++++++++++++++++++++++++++----------------------------------------------
--------------------------------------------------------------------------++++++
+++----------------------------------------------+++++++++++++++++++++++++++++++
+----+++++++-+++++----+++-------------------------------------------------------
-+++++++-++++-+++++++++-------++++++++++++++++++++++++++++++++++++++++++++++++++
++++++---------------+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
+-++++++++++++-------------------++++++++++++++++++++-++++++++++++++++++++++++++
++++++-+------------------------------------------------------------------------
-+++++++++++-+++++++----------------------------------------+-------+-----------
-+------+-----------------------------------------------------------------------
-+------------------------------------------------------------------------------
-+------------------------------------------------------------------------------
-------------------+-------+----------------------------------------------------
------------------------------+-------------------------------------------------
------------------------------------------------------+-------------------------
-+------------------------------------------------------------------------------
-++---------------------------------------++++++++++++++++++++++++++++++++++++++
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

balance = 1000000
```

- ì•½ê°„ì˜ ì‹œê°„ ì§€ì—°ì„ ì¤€ ê²ƒë§Œìœ¼ë¡œë„ í”„ë¡œê·¸ë¨ì˜ ê²°ê³¼ê°€ ì›í•˜ëŠ” ëŒ€ë¡œ ë‚˜ì˜¤ì§€ ì•ŠìŒ.
- ë™ê¸°í™” ë¬¸ì œë¥¼ í•´ê²°í•˜ì§€ ëª»í–ˆê¸° ë•Œë¬¸ì— ìƒê¸´ ë¬¸ì œì 
-  **ê³µí†µë³€ìˆ˜(common variable)ì— ëŒ€í•œ ë™ì‹œ ì—…ë°ì´íŠ¸(concurrent update)** ë•Œë¬¸

=> ì´ë¥¼ í•´ê²°í•˜ëŠ” ë°©ë²•ì€ ê³µí†µë³€ìˆ˜ì— ì ‘ê·¼í•˜ëŠ” ì“°ë ˆë“œë¥¼ í•˜ë‚˜ë§Œ ì¡´ì¬í•˜ë„ë¡ ê´€ë¦¬! ê³µí†µë³€ìˆ˜ êµ¬ì—­ = **ì„ê³„êµ¬ì—­**



### 2. ì„ê³„êµ¬ì—­(Critical section) ë¬¸ì œ

ì„ê³„êµ¬ì—­: ì—¬ëŸ¬ ê°œì˜ ì“°ë ˆë“œê°€ ìˆ˜í–‰ë˜ëŠ” ì‹œìŠ¤í…œì—ì„œ ê° ì“°ë ˆë“œë“¤ì´ **ê³µìœ í•˜ëŠ” ë°ì´í„°(ë³€ìˆ˜, í…Œì´ë¸”, íŒŒì¼ ë“±)ë¥¼ ë³€ê²½í•˜ëŠ” ì½”ë“œ ì˜ì—­**

```java
void deposit(int amount) {
  balance = balance + amount;
}
void withdraw(int amount) {
  balance = balance - amount;
}
```

=> ì€í–‰ê³„ì¢Œ ë¬¸ì œì—ì„œì˜ ì„ê³„êµ¬ì—­

í•´ê²°ë°©ë²•

- **Mutual exclusion(ìƒí˜¸ë°°íƒ€)**: ì˜¤ì§ í•œ ì“°ë ˆë“œë§Œì´ ì§„ì… ê°€ëŠ¥. í•œ ì“°ë ˆë“œê°€ ì„ê³„êµ¬ì—­ì—ì„œ ìˆ˜í–‰ ì¤‘ì¸ ìƒíƒœì—ì„œëŠ” ë‹¤ë¥¸ ì“°ë ˆë“œëŠ” ì ˆëŒ€ ì´ êµ¬ì—­ì— ì ‘ê·¼í•  ìˆ˜ ì—†ë‹¤.
- **Progress(ì§„í–‰)**: í•œ ì„ê³„êµ¬ì—­ì— ì ‘ê·¼í•˜ëŠ” ì“°ë ˆë“œë¥¼ ê²°ì •í•˜ëŠ” ê²ƒì€ ìœ í•œ ì‹œê°„ ì´ë‚´ì— ì´ë£¨ì–´ì ¸ì•¼ í•œë‹¤.
- **Bounded waiting(ìœ í•œëŒ€ê¸°)**: ì„ê³„êµ¬ì—­ìœ¼ë¡œ ì§„ì…í•˜ê¸° ìœ„í•´ ëŒ€ê¸°í•˜ëŠ” ëª¨ë“  ì“°ë ˆë“œëŠ” ìœ í•œì‹œê°„ ì´ë‚´ì— í•´ë‹¹ ì„ê³„êµ¬ì—­ìœ¼ë¡œ ì§„ì…í•  ìˆ˜ ìˆì–´ì•¼ í•œë‹¤.



#### í”„ë¡œì„¸ìŠ¤/ì“°ë ˆë“œ ë™ê¸°í™” ì´ìœ ?

- ì›í•˜ëŠ” ê²°ê³¼ ê°’ì„ ë„ì¶œí•˜ê¸° ìœ„í•´ **ì„ê³„êµ¬ì—­ ë¬¸ì œ í•´ê²°**
- í”„ë¡œì„¸ìŠ¤ì˜ **ì‹¤í–‰ ìˆœì„œ** ì œì–´
- ë¹„íš¨ìœ¨ì„± ì œê±°



### 3. Semaphore(ì„¸ë§ˆí¬ì–´)

ì„¸ë§ˆí¬ì–´: ë™ê¸°í™”ë¥¼ ìœ„í•´ ë§Œë“¤ì–´ì§„ ì†Œí”„íŠ¸ì›¨ì–´. ëŒ€í‘œì ì¸ ë™ê¸°í™” ë„êµ¬. **í•œ ë²ˆì— í•˜ë‚˜ì˜ í”„ë¡œì„¸ìŠ¤ë§Œ ì ‘ê·¼ ê°€ëŠ¥í•˜ê²Œ ë§Œë“¤ì–´ ì£¼ëŠ” ê²ƒ**

ì„ê³„ êµ¬ì—­ì— ì§„ì…í•˜ê¸° ìœ„í•´, ì„ê³„ êµ¬ì—­ì— ì§„ì…í•  ìˆ˜ ìˆëŠ” ê¶Œí•œì„ íšë“í•˜ê³  ê¶Œí•œì„ íšë“í•œ ê²½ìš°ì—ë§Œ ì„ê³„ êµ¬ì—­ì— ì§„ì…í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ë™ê¸°í™” ë°©ì‹. ìë°”ì˜ ê²½ìš° java.util.concurrent.Sepaphoreë¥¼ í†µí•´ ì„¸ë§ˆí¬ì–´ ê°ì²´ ìƒì„±í•˜ì—¬, ì„ê³„ êµ¬ì—­ ë¬¸ì œ ë°©ì§€ ê°€ëŠ¥ 

acquire(): test, release(): increment

```java
// ì„¸ë§ˆí¬ì–´ êµ¬ì¡°
class Semaphore {
  int value;      // number of permits
  Semaphore(int value) {
    // ...
  }
  void acquire() {
    value--;
    if (value < 0) {
      // add this process/thread to list
      // block
    }
  }
  void release() {
    value++;
    if (value <= 0) {
      // remove a process P from list
      // wakeup P
    }
  }
}
```

acquire(): valueê°’ì„ ê°ì†Œì‹œí‚¤ê³  ë§Œì•½ valueê°’ì´ 0ë³´ë‹¤ ì‘ìœ¼ë©´ ì´ë¯¸ í•´ë‹¹ ì„ê³„êµ¬ì—­ì— ì–´ëŠ í”„ë¡œì„¸ìŠ¤ê°€ ì¡´ì¬í•œë‹¤. ê·¸ë ‡ê¸° ë•Œë¬¸ì— í˜„ì¬ í”„ë¡œì„¸ìŠ¤ëŠ” ì ‘ê·¼í•˜ì§€ ëª»í•˜ë„ë¡ ë§‰ëŠ”ë‹¤. -> ê¸°ë‹¤ë¦¬ëŠ” ì¤„(list)ì— ì¶”ê°€í•œ í›„ **block**ì„ ê±¸ì–´ì¤€ë‹¤.

release(): valueê°’ì„ ì¦ê°€ì‹œí‚¤ê³  ë§Œì•½ valueê°’ì´ 0ë³´ë‹¤ ì‘ê±°ë‚˜ ê°™ìœ¼ë©´ ì„ê³„êµ¬ì—­ì— ì§„ì…í•˜ë ¤ê³  ëŒ€ê¸°í•˜ëŠ” í”„ë¡œì„¸ìŠ¤ê°€ listì— ë‚¨ì•„ìˆë‹¤ëŠ” ì˜ë¯¸ì´ë¯€ë¡œ ê·¸ ì¤‘ì—ì„œ í•˜ë‚˜ë¥¼ êº¼ë‚´ì–´ ì„ê³„êµ¬ì—­ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë„ë¡ í•´ì¤€ë‹¤. (????)

![img](https://blog.kakaocdn.net/dn/dlSD4A/btqEW3K2nkb/GIN21pjkv6K3q1FmEPRcSk/img.png)

![img](https://blog.kakaocdn.net/dn/vaRWg/btqEWtcpQWk/RCA5Cn7XN8VdACAILDILN0/img.png)



#### ì€í–‰ ê³„ì¢Œ ë¬¸ì œ

ìœ„ì˜ ì€í–‰ê³„ì¢Œ ë¬¸ì œì— ì„¸ë§ˆí¬ì–´ë¥¼ ì ìš©í•´ë³¸ë‹¤. ìœ„ì—ì„œ ì„ê³„êµ¬ì—­ì€ BankAccount í´ë˜ìŠ¤ ë‚´ë¶€ì˜ ì…ì¶œë ¥ ë¶€ë¶„ì´ì—ˆìœ¼ë¯€ë¡œ ì—¬ê¸°ì— ì„¸ë§ˆí¬ì–´ë¥¼ ì ìš©í•´ ë³´ë©´

```java
import java.util.concurrent.Semaphore;

class BankAccount {
    int balance;
    Semaphore s;

    BankAccount() { 	 // BankAccount í´ë˜ìŠ¤ì˜ ìƒì„±ìê°€ í˜¸ì¶œë˜ë©´ ì„¸ë§ˆí¬ì–´ë¥¼ ë§Œë“ ë‹¤.
        s = new Semaphore(1); // value ê°’ì„ 1ë¡œ ì´ˆê¸°í™”í•œë‹¤.
    }

    void deposit(int amount) {
        try {
            s.acquire();	// ì„ê³„êµ¬ì—­ì— ë“¤ì–´ê°€ê¸°ë¥¼ ìš”ì²­í•œë‹¤.
        } catch (InterruptedException e) { }
		/* ì„ê³„ êµ¬ì—­ */
        balance += amount;

        s.release();		// ì„ê³„êµ¬ì—­ì—ì„œ ë‚˜ê°„ë‹¤.
    }

    void withdraw(int amount) {
        try {
            s.acquire();
        } catch (InterruptedException e) { }
        
        balance -= amount;

        s.release();
    }

    int getBalance() {
        return balance;
    }
}
```

value -> ì„ê³„êµ¬ì—­ì— ëª‡ ê°œì˜ í”„ë¡œì„¸ìŠ¤ê°€ ì ‘ê·¼í•  ìˆ˜ ìˆëŠ”ì§€

ê²°ê³¼ëŠ” ``balance = 0``ìœ¼ë¡œ ì •ìƒì ìœ¼ë¡œ ë‚˜ì˜¤ëŠ” ê²ƒì„ í™•ì¸ í•  ìˆ˜ ìˆë‹¤. (???)



#### Ordering

ì„¸ë§ˆí¬ì–´ëŠ” mutual exclusion ë¿ ì•„ë‹ˆë¼ orderingì„ í•˜ê¸° ìœ„í•´ì„œë„ ì‚¬ìš©í•œë‹¤. **í”„ë¡œì„¸ìŠ¤ì˜ ìˆœì„œë¥¼ ì›í•˜ëŠ” ìˆœì„œë¡œ ì„¤ì • ê°€ëŠ¥**

ex. í”„ë¡œì„¸ìŠ¤ê°€ P1, P2 2ê°œ ì¡´ì¬. ì›í•˜ëŠ” ìˆœì„œëŠ” P1 -> P2

``` sem value = 0 ```

|      P1       |      P2       |
| :-----------: | :-----------: |
|               | sem.acquire() |
|   Section 1   |   Section 2   |
| sem.release() |               |

1. P1ì´ ë¨¼ì € ì‹¤í–‰ë  ê²½ìš°
   - Section 1 ì´ì „ì— ì•„ë¬´ ë™ì‘ì´ ì—†ìœ¼ë¯€ë¡œ ë°”ë¡œ ìˆ˜í–‰
   - sem.release()ë¥¼ ë§Œë‚˜ë©´ value ê°’ì„ 1 ì¦ê°€. ì„¸ë§ˆí¬ì–´ íì— ìˆëŠ” í”„ë¡œì„¸ìŠ¤ë¥¼ ê¹¨ì›Œì£¼ëŠ” ë° í˜„ì¬ íì— í”„ë¡œì„¸ìŠ¤ê°€ ì—†ìœ¼ë¯€ë¡œ ì•„ë¬´ ë™ì‘ í•˜ì§€ ì•ŠëŠ”ë‹¤.
   - P2 ì‹¤í–‰
   - P2ì˜ sem.acquire()ë¥¼ ë§Œë‚˜ë©´ í˜„ì¬ value ê°’ì€ 1ì´ê³  ì´ë¥¼ 1 ê°ì†Œì‹œí‚¤ë©´ 0ì´ ëœë‹¤. value = 0 ì´ë©´ block ì—°ì‚°ì„ í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ, Section 2ê°€ ìˆ˜í–‰ëœë‹¤.
2. P2ê°€ ë¨¼ì € ì‹¤í–‰ë  ê²½ìš°
   - Section 2 ì´ì „ì— sem.acquire()ì´ ìˆìœ¼ë¯€ë¡œ ì´ë¥¼ ìˆ˜í–‰í•˜ëŠ”ë°, í˜„ì¬ value ê°’ì‘ 0ì´ê³  ì´ë¥¼ 1 ê°ì†Œ ì‹œí‚¤ë©´ -1. value ê°’ì´ ìŒìˆ˜ë©´ í•´ë‹¹ í”„ë¡œì„¸ìŠ¤ë¥¼ block ì‹œí‚¨ë‹¤. (ì„¸ë§ˆí¬ì–´ íì— ì‚½ì…)
   - P1ì´ ì‹¤í–‰ë˜ë©´ Section 1 ìˆ˜í–‰. 
   - sem.release()ë¥¼ ë§Œë‚˜ë©´ valueê°’ì„ 1 ì¦ê°€. ì„¸ë§ˆí¬ì–´ íì— ìˆëŠ” P2 í”„ë¡œì„¸ìŠ¤ë¥¼ ê¹¨ì›Œì¤€ë‹¤. (í˜„ì¬ value = 0)
   - P2ì˜ Section 2ê°€ ìˆ˜í–‰ë¨



#### Orderingì„ ì ìš©í•œ ì€í–‰ ê³„ì¢Œ ë¬¸ì œ

í”„ë¡œì„¸ìŠ¤ì˜ ì‹¤í–‰ ìˆœì„œëŠ” ë°˜ë“œì‹œ ì…ê¸ˆ -> ì¶œê¸ˆ ìˆœì„œ

```java
class BankAccount {
	int balance;

	Semaphore sem, semOrder;
	BankAccount() {
		sem = new Semaphore(1);
		semOrder = new Semaphore(0);   // Ordeingì„ ìœ„í•œ ì„¸ë§ˆí¬
	}

	void deposit(int amount) {
		try {
			sem.acquire(); // -í•´ì„œ ìŒìˆ˜ ì•„ë‹ˆë©´ ì‹¤í–‰
		} catch (InterruptedException e) {}
		int temp = balance + amount;
		System.out.print("+");
		balance = temp;
		sem.release();
		semOrder.release();   // blockëœ ì¶œê¸ˆ í”„ë¡œì„¸ìŠ¤ê°€ ìˆë‹¤ë©´ ê¹¨ì›Œì¤€ë‹¤.
	}
	void withdraw(int amount) {
		try {
			semOrder.acquire();   // ì¶œê¸ˆì„ ë¨¼ì €í•˜ë ¤ê³  í•˜ë©´ blockí•œë‹¤.
			sem.acquire();
		} catch (InterruptedException e) {}
		int temp = balance - amount;
		System.out.print("-");
		balance = temp;
		sem.release();
	}
	int getBalance() {
		return balance;
	}
}
```

-- ì…ê¸ˆê³¼ ì¶œê¸ˆì„ ë²ˆê°ˆì•„ ê°€ë©´ì„œ í•˜ê³  ì‹¶ë‹¤ë©´

```java
Semaphore sem, semDeposit, semWithraw;
BankAccount() {
	sem = new Semaphore(1);
	semDeposit = new Semaphore(0);
	semWithraw = new Semaphore(0);
}

void deposit(int amount) {
	try {
		sem.acquire();
		int temp = balance + amount;
		System.out.print("+");
		balance = temp;
		sem.release();
		semWithraw.release();
		semDeposit.acquire();   // ì…ê¸ˆí›„ì—ëŠ” ë°˜ë“œì‹œ ì¶œê¸ˆì„ í•´ì•¼ í•˜ë¯€ë¡œ ìì‹ ì„ blockí•œë‹¤.
	} catch (InterruptedException e) {}
}
void withdraw(int amount) {
	try {
		semWithraw.acquire();  // ì…ê¸ˆë³´ë‹¤ ë¨¼ì € ìˆ˜í–‰í•˜ëŠ” ê²ƒì„ ë§‰ëŠ”ë‹¤.
		sem.acquire();
	} catch (InterruptedException e) {}
	int temp = balance - amount;
	System.out.print("-");
	balance = temp;
	sem.release();
	semDeposit.release();  // ì¶œê¸ˆ ìˆ˜í–‰ì´ ì™„ë£Œë˜ë©´ blockë˜ì—ˆë˜ ì…ê¸ˆ í”„ë¡œì„¸ìŠ¤ë¥¼ ê¹¨ì›Œì¤€ë‹¤.
}
int getBalance() {
	return balance;
}
```



### 4. ì „í†µì  ë™ê¸°í™” ì˜ˆì œ (Classical Synchronization Problems)

#### 4 - 1. Producer-Consumer Problem

ìƒì‚°ì - ì†Œë¹„ì ë¬¸ì œ: ìƒì‚°ìê°€ ë°ì´í„°ë¥¼ ìƒì‚°í•˜ë©´ ì†Œë¹„ìëŠ” ê·¸ ë°ì´í„°ë¥¼ ì†Œë¹„í•˜ëŠ” í˜•íƒœ

![img](https://user-images.githubusercontent.com/34755287/54337393-1ee43880-4672-11e9-9ca9-b9d0b414b833.png)

ìƒì‚°ì - ì†Œë¹„ì ë¬¸ì œ: ëŒ€ë¶€ë¶„ì€ ìƒì‚°ìì—ì„œ ìƒì‚°í•œ ë°ì´í„°ë¥¼ ì†Œë¹„ìê°€ í•œ ë²ˆì— ì†Œë¹„í•˜ëŠ” ê²½ìš°ëŠ” ë“œë¬¼ë‹¤. ìƒì‚°í•œ ë°ì´í„°ëŠ” **buffer**ë¼ëŠ” ì €ì¥ ê³µê°„(ë©”ëª¨ë¦¬ ê³µê°„)ì— ì €ì¥í•´ë‘ê³  ì†Œë¹„ìëŠ” ì—¬ê¸°ì„œ í•„ìš”í•œ ë§Œí¼ ê°€ì ¸ê°„ë‹¤.

ë²„í¼ì˜ í¬ê¸°ëŠ” í˜„ì‹¤ì ìœ¼ë¡œ ìœ í•œí•˜ë‹¤. ê·¸ëŸ¬ë¯€ë¡œ ìƒì‚°ìëŠ” ë²„í¼ ê³µê°„ì´ ê°€ë“ì°¨ë©´ ë” ì´ìƒ ì €ì¥í•  ìˆ˜ ì—†ë‹¤. ì†Œë¹„ìëŠ” ë²„í¼ê°€ ë¹„ì–´ìˆìœ¼ë©´ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ë‹¤. --> ìœ í•œí•œ ë²„í¼ í¬ê¸°: **bounded buffer**

```java
class Test {
	public static void main(String[] arg) {
		Buffer b = new Buffer(100);
		Producer p = new Producer(b, 10000);
		Consumer c = new Consumer(b, 10000);
		p.start();
		c.start();
		try {
			p.join();
			c.join();
		} catch (InterruptedException e) {}
		System.out.println("Number of items in the buf is " + b.count);
	}
}

class Buffer {
	int[] buf;
	int size;
	int count;
	int in;
	int out;
	Buffer(int size) {
		buf = new int[size];
		this.size = size;
		count = in = out = 0;
	}
	void insert(int item) {
		/* check if buf is full */
		while (count == size)
			;
		/* buf is not full */
		buf[in] = item;
		in = (in+1)%size;	// ë²„í¼ì˜ ë§ˆì§€ë§‰ ì¸ë±ìŠ¤ë¡œ ê°€ë©´ ë‹¤ì‹œ ì²˜ìŒìœ¼ë¡œ ë˜ëŒì•„ ê°
		count++;
	}
	int remove() {
		/* check if buf is empty */
		while (count == 0)
			;
		/* buf is not empty */
		int item = buf[out];
		out = (out+1)%size;
		count--;
		return item;
	}
}

/****** ìƒì‚°ì ******/
class Producer extends Thread {
	Buffer b;
	int N;
	Producer(Buffer b, int N) {
		this.b = b; 
        this.N = N;
	}
	public void run() {
		for (int i=0; i<N; i++)
			b.insert(i);
	}
}
/****** ì†Œë¹„ì ******/
class Consumer extends Thread {
	Buffer b;
	int N;
	Consumer(Buffer b, int N) {
		this.b = b; 
        this.N = N;
	}
	public void run() {
		int item;
		for (int i=0; i<N; i++)
			item = b.remove();
	}
}
```

- `buf`: Bounded buffer
- `size`: ë²„í¼ í¬ê¸°
- `count`: ë²„í¼ì— ì €ì¥ëœ ë°ì´í„° ê°œìˆ˜
- `in`: ìƒì‚°í•œ ë°ì´í„°ë¥¼ ë‹´ì„ ë²„í¼ ì¸ë±ìŠ¤
- `out`: ì†Œë¹„í•  ë°ì´í„°ë¥¼ ê°€ë¦¬í‚¤ëŠ” ë²„í¼ ì¸ë±ìŠ¤

í¬ê¸°ê°€ 100ì¸ ë²„í¼ë¥¼ ìƒì„± -> 2ê°œì˜ ì“°ê²Œë“œê°€ ê°ê° ìƒì‚°ì, ì†Œë¹„ì ì—­í•  í•˜ë©° 10000ë²ˆì”© ìƒì‚°ê³¼ ì†Œë¹„í•¨. 

ì‹¤ì œ ì½”ë“œë¥¼ ìˆ˜í–‰í•˜ë©´, ë¬´í•œ ë£¨í”„ì— ë¹ ì§€ê±°ë‚˜, count ê°’ì— ì „í˜€ ì˜ˆìƒí•˜ì§€ ì•Šì€ ê°’ì´ ì¶œë ¥ë˜ê¸°ë„ í•œë‹¤.

=> ë™ê¸°í™” ë¬¸ì œ. ìƒì‚°ìì™€ ì†Œë¹„ìê°€ ë™ì‹œì— ì ‘ê·¼í•˜ëŠ” ê³µí†µ ë³€ìˆ˜ì¸ buf, countë¥¼ ë‘ í”„ë¡œì„¸ìŠ¤ê°€ ë™ì‹œì— ì—…ë°ì´íŠ¸í•˜ê¸° ë•Œë¬¸.  **ì„ê³„êµ¬ì—­ì— ë™ì‹œì— ì ‘ê·¼í–ˆê¸° ë•Œë¬¸ì´ë‹¤.**

==> í•´ê²° ë°©ë²•: ìœ„ì—ì„œ ë‚˜ì™”ë˜ ë°©ë²•ì¸ "ì„¸ë§ˆí¬ì–´"ë¥¼ ì‚¬ìš©í•˜ì—¬ mutual exclutsionì„ ë³´ì¥í•˜ëŠ” ê²ƒ. ì„ê³„êµ¬ì—­ì„ ë™ì‹œì— ì ‘ê·¼í•˜ëŠ” ê²ƒì„ ë°©ì§€í•˜ê³  í•˜ë‚˜ì˜ í”„ë¡œì„¸ìŠ¤ë§Œ í—ˆìš©í•´ì•¼ í•œë‹¤.

```java
class Buffer {
	int[] buf;
	int size;
	int count;
	int in;
	int out;
	Semaphore mutex;   // ì„¸ë§ˆí¬ ì„ ì–¸

	Buffer(int size) {
		buf = new int[size];
		this.size = size;
		count = in = out = 0;
		mutex = new Semaphore(1);
	}

	void insert(int item) {
		/* check if buf is full */
		while (count == size)
			;
		/* buf is not full */
		try {
            mutex.acquire();
            buf[in] = item;
            in = (in+1)%size;
            count++;
            mutex.release();
		} catch(InterruptedException e) {}
	}

	int remove() {
		/* check if buf is empty */
		while (count == 0)
			;
		/* buf is not empty */
		try {
			mutex.acquire();
			int item = buf[out];
			out = (out+1)%size;
			count--;
			mutex.release();
			return item;
		} catch(InterruptedException e) {}
      
		return -1;
	}
}
```

í•˜ì§€ë§Œ, ì—¬ê¸°ì„œ ë°œìƒí•˜ëŠ” ë¬¸ì œì ì€ **busy waiting**ì´ë‹¤.

**busy waiting**: ìƒì‚°ê³¼ ì†Œë¹„í•˜ê¸° ì „ì— ë²„í¼ê°€ ê°€ë“ ì°¼ëŠ”ì§€ ë¹„ì–´ ìˆëŠ”ì§€ í™•ì¸í•˜ëŠ” ë¬´í•œ ë°˜ë³µë¬¸. ì´ëŠ” ì•„ë¬´ ì¼ë„ í•˜ì§€ ì•Šìœ¼ë©´ì„œ ë¬´í•œìœ¼ë¡œ ë°˜ë³µí•˜ì—¬ CPUë¥¼ ì ìœ í•˜ê³  ìˆìœ¼ë¯€ë¡œ ë§¤ìš° ë¹„íš¨ìœ¨ì ì´ë‹¤.

=> ì´ ë˜í•œ ì„¸ë§ˆí¬ì–´ë¡œ í•´ê²°í•  ìˆ˜ ìˆë‹¤.

```java
class Buffer {
	int[] buf;
	int size;
	int count;
	int in;
	int out;
	Semaphore mutex, full, empty;

	Buffer(int size) {
		buf = new int[size];
		this.size = size;
		count = in = out = 0;
		mutex = new Semaphore(1);
		full = new Semaphore(0);
		empty = new Semaphore(size);
	}

	void insert(int item) {
		try {
            empty.acquire();    // ë²„í¼ì˜ ë¹„ì–´ìˆëŠ” ê³µê°„ì„ 1 ê°ì†Œì‹œí‚¨ë‹¤.(ë¹„ì–´ìˆëŠ” ê³µê°„ì´ ì—†ìœ¼ë©´ block)
            mutex.acquire();
            buf[in] = item;
            in = (in+1)%size;
            count++;
            mutex.release();
            full.release();    // ë²„í¼ì˜ ì°¬ ê³µê°„ì„ 1 ì¦ê°€ì‹œí‚¨ë‹¤.
          } catch(InterruptedException e) {}
	}

	int remove() {
		try {
            full.acquire();    // ë²„í¼ì˜ ì°¬ ê³µê°„ì„ 1 ê°ì†Œì‹œí‚¨ë‹¤.(ë²„í¼ê°€ ëª¨ë‘ ë¹„ì–´ìˆìœ¼ë©´ block)
            mutex.acquire();
            int item = buf[out];
            out = (out+1)%size;
            count--;
            mutex.release();
            empty.release();   // ë²„í¼ì˜ ë¹„ì–´ìˆëŠ” ê³µê°„ì„ 1 ì¦ê°€ì‹œí‚¨ë‹¤.
            return item;
          } catch(InterruptedException e) {}
		return -1;
	}
```

busy watingì„ í•´ê²°í•˜ê¸° ìœ„í•´ ë‘ ê°œì˜ ì„¸ë§ˆí¬ì–´ ì¶”ê°€

- `empty`: ë²„í¼ì—ì„œ ë¹„ì–´ìˆëŠ” ê³µê°„ì˜ ê°œìˆ˜(ì´ˆê¸°ê°’ size)
- `full`: ë²„í¼ì—ì„œ ì°¨ìˆëŠ” ê³µê°„ì˜ ê°œìˆ˜(ì´ˆê¸°ê°’ 0)

emptyëŠ” ì´ˆê¸°í™”í•  ë•Œ ë²„í¼ê°€ ëª¨ë‘ ë¹„ì–´ìˆìœ¼ë¯€ë¡œ ë²„í¼ì˜ í¬ê¸°ë¡œ ì´ˆê¸°í™”. fullì€ ì´ˆê¸° ë²„í¼ì—ëŠ” ì•„ë¬´ ë°ì´í„°ê°€ ì—†ìœ¼ë¯€ë¡œ 0ìœ¼ë¡œ ì´ˆê¸°í™”

ë°ì´í„°ë¥¼ ìƒì„±í•˜ê¸° ì „ì— ë¹„ì–´ìˆëŠ” ê³µê°„ì´ ìˆëŠ”ì§€ í™•ì¸í•œë‹¤. ì—†ë‹¤ë©´ emptyì„¸ë§ˆí¬ì˜ valueê°’ì´ -1ì´ ë˜ë¯€ë¡œ blockì´ ë˜ê³ , ìˆë‹¤ë©´ ì„ê³„êµ¬ì—­ ë‚´ë¶€ë¡œ ì§„ì…í•˜ì—¬ ë°ì´í„°ë¥¼ ìƒì„±í•œë‹¤. ìƒì„±ì´ ì™„ë£Œë˜ë©´ fullì„¸ë§ˆí¬ì˜ valueê°’ì„ 1 ì¦ê°€ì‹œí‚¨ë‹¤.



#### 4 - 2 Readers-Writers Problem

Readers-Writers ë¬¸ì œ: ê³µí†µ ë°ì´í„°ë² ì´ìŠ¤ì— ì ‘ê·¼í•˜ëŠ” ê²½ìš°. 

í•˜ë‚˜ì˜ ë°ì´í„°ë² ì´ìŠ¤ì— readerì™€ writerê°€ ì ‘ê·¼í•˜ë¯€ë¡œ, ë°ì´í„°ë² ì´ìŠ¤ëŠ” ì„ê³„êµ¬ì—­ìœ¼ë¡œ ì„¤ì •í•´ì•¼ í•œë‹¤. ì¦‰, í•œ ë²ˆì— í•œ ê°œì˜ í”„ë¡œì„¸ìŠ¤ë§Œ ì ‘ê·¼ê°€ëŠ¥í•˜ë„ë¡ í•´ì•¼ í•œë‹¤.

ë°ì´í„°ë² ì´ìŠ¤ì— ì ‘ê·¼í•˜ëŠ” í”„ë¡œì„¸ìŠ¤ ì¢…ë¥˜ë¥¼ writerê³¼ readerë¡œ ë‚˜ëˆˆë‹¤.

reader: **ë°ì´í„°ë² ì´ìŠ¤ ë‚´ì˜ ì •ë³´ë¥¼ ë°”ê¾¸ì§€ ì•Šê³  ì½ê¸°ë§Œ í•˜ëŠ” í”„ë¡œì„¸ìŠ¤**ì´ë¯€ë¡œ, ì—¬ëŸ¬ reader í”„ë¡œì„¸ìŠ¤ê°€ ë™ì‹œì— ë°ì´í„°ë² ì´ìŠ¤ì— ì ‘ê·¼í•˜ëŠ” ê²ƒì„ í—ˆìš©í•œë‹¤.

writer: **ë°ì´í„°ë² ì´ìŠ¤ì˜ ë‚´ìš©ì„ ë°”ê¾¸ëŠ” í”„ë¡œì„¸ìŠ¤ì´ë¯€ë¡œ mutual exclusion**ì„ ë³´ì¥í•´ì•¼ í•œë‹¤.

=> ìš°ì„ ìˆœìœ„ì— ë”°ë¥¸ í•´ê²° ë°©ë²•

- The first R/W problem (readers-preference): reader í”„ë¡œì„¸ìŠ¤ì— ìš°ì„ ê¶Œì„ ì£¼ëŠ” ê²ƒ. í•œ reader í”„ë¡œì„¸ìŠ¤ê°€ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì½ê³  ìˆëŠ” ë™ì•ˆ writer í”„ë¡œì„¸ìŠ¤ê°€ ì˜¤ë©´ ê¸°ë‹¤ë¦°ë‹¤. ì´ ìƒí™©ì—ì„œ reader í”„ë¡œì„¸ìŠ¤ê°€ ì˜¨ë‹¤ë©´ writer í”„ë¡œì„¸ìŠ¤ê°€ ê¸°ë‹¤ë¦¬ëŠ” ê²ƒì„ ë¬´ì‹œí•˜ê³  ë°ì´í„°ë² ì´ìŠ¤ì— ì ‘ê·¼í•˜ì—¬ ì½ëŠ”ë‹¤. ê·¸ ê²°ê³¼, ë‘ readerê°€ ë™ì‹œì— ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì½ëŠ” ìƒí™©ì´ ëœë‹¤.
- The second R/W problem (writers-preference): writer í”„ë¡œì„¸ìŠ¤ê°€ ê¸°ë‹¤ë¦¬ëŠ” ìƒí™©ì—ì„œ ë‹¤ë¥¸ reader í”„ë¡œì„¸ìŠ¤ê°€ ë“¤ì–´ì˜¨ë‹¤ë©´, ê¸°ì¡´ì˜ writer í”„ë¡œì„¸ìŠ¤ ë‹¤ìŒ ìˆœì„œë¡œ ê¸°ë‹¤ë ¤ì•¼ í•œë‹¤.
- The third R/W problem: ì•„ë¬´ì—ê²Œë„ ìš°ì„ ìˆœìœ„ë¥¼ ì£¼ì§€ ì•ŠëŠ”ë‹¤.



#### 4 - 3 Dining Philosopher Problem

ì‹ì‚¬í•˜ëŠ” ì² í•™ì ë¬¸ì œ: ì›í˜• í…Œì´ë¸”ì— 5ëª…ì˜ ì² í•™ìì™€ 5ê°œì˜ ì “ê°€ë½ì´ ìˆëŠ” ìƒí™©. ê° ì² í•™ìëŠ” ì‹ì‚¬ -> ìƒê° -> ì‹ì‚¬ -> ... ë¥¼ ë°˜ë³µí•œë‹¤. ë‹¨, ì‹ì‚¬ë¥¼ í•˜ê¸° ìœ„í•´ì„œëŠ” 2ê°œì˜ ì “ê°€ë½ì´ í•„ìš”í•˜ë‹¤.

![img](https://user-images.githubusercontent.com/34755287/54337394-1f7ccf00-4672-11e9-9fc0-cb98c4171239.png)

ì “ê°€ë½ì€ í•œ ì² í•™ìê°€ ê°€ì ¸ê°€ë©´ ë‹¤ë¥¸ ì² í•™ìëŠ” ì´ ì “ê°€ë½ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤. í•œ ì “ê°€ë½ì„ í•œ ë²ˆì— ì ìœ í•  ìˆ˜ ìˆëŠ” ì² í•™ìëŠ” **í•œ ëª…**ì´ë¯€ë¡œ ì„¸ë§ˆí¬ì–´ë¡œ ë§Œë“¤ ìˆ˜ ìˆë‹¤. í•œ ì² í•™ìê°€ ì‹ì‚¬ë¥¼ í•˜ë ¤ê³  í•˜ë©´, ì™¼ìª½ ì “ê°€ë½ê³¼ ì˜¤ë¥¸ìª½ ì “ê°€ë½ ìˆœì„œë¡œ ê°€ì ¸ê°€ê³ , ì‹ì‚¬ê°€ ëë‚˜ë©´ ë™ì¼í•˜ê²Œ ì™¼ìª½ ì “ê°€ë½, ì˜¤ë¥¸ìª½ ì “ê°€ë½ ìˆœì„œë¡œ ë‚´ë ¤ë†“ëŠ”ë‹¤.

```java
import java.util.concurrent.Semaphore;

class Philosopher extends Thread {
	int id; // philosopher id
	Semaphore lstick, rstick; // left, right chopsticks
	Philosopher(int id, Semaphore lstick, Semaphore rstick) {
		this.id = id;
		this.lstick = lstick;
		this.rstick = rstick;
	}

	public void run() {
		try {
			while (true) {
				lstick.acquire();
				rstick.acquire();
				eating();
				lstick.release();
				rstick.release();
				thinking();
			}
		}catch (InterruptedException e) { }
	}

	void eating() {
		System.out.println("[" + id + "] eating");
	}

	void thinking() {
		System.out.println("[" + id + "] thinking");
	}
}

class Test {
	static final int num = 5; // number of philosphers & chopsticks
	public static void main(String[] args) {
        int i;
        /* chopsticks */
        Semaphore[] stick = new Semaphore[num];
        for (i=0; i<num; i++)
            stick[i] = new Semaphore(1);
        /* philosophers */
        Philosopher[] phil = new Philosopher[num];
        for (i=0; i<num; i++)
            phil[i] = new Philosopher(i, stick[i], stick[(i+1)%num]);
        /* let philosophers eat and think */
        for (i=0; i<num; i++)
            phil[i].start();
      }
}
```

5ê°œì˜ ì “ê°€ë½ ì„¸ë§ˆí¬ì–´, 5ê°œì˜ ì² í•™ì ì“°ë ˆë“œë¥¼ ìƒì„±í•œë‹¤. ê° ì² í•™ì ì“°ë ˆë“œì—ëŠ” ë¬´í•œ ë°˜ë³µë¬¸ìœ¼ë¡œ ì™¼ìª½ ì “ê°€ë½ê³¼ ì˜¤ë¥¸ìª½ ì “ê°€ë½ì„ ìˆœì„œëŒ€ë¡œ ì§‘ì€ í›„ ì‹ì‚¬ë¥¼ í•˜ê³  (ëª‡ ë²ˆ ì² í•™ìê°€ ì‹ì‚¬í–ˆë‹¤ëŠ” ê²ƒì„ ì¶œë ¥), ë‹¤ì‹œ ì™¼ìª½ ì “ê°€ë½, ì˜¤ë¥¸ìª½ ì “ê°€ë½ ìˆœìœ¼ë¡œ ë‚´ë ¤ë†“ê³  ìƒê°í•œë‹¤.

ì½”ë“œì—ì„œëŠ” ë¬¸ì œì ì´ ì—†ì–´ë³´ì´ì§€ë§Œ, ì´ë¥¼ ì‹¤í–‰í•˜ë©´ ì¤‘ê°„ì— ë” ì´ìƒ ì‹¤í–‰ë˜ì§€ ì•ŠëŠ”ë‹¤.

ì´ëŠ” ëŒ€í‘œì ì€ **starvation** ë¬¸ì œ ì¤‘ í•˜ë‚˜. ëª¨ë“  ì² í•™ìê°€ ì‹ì‚¬ë¥¼ í•˜ì§€ ëª»í•˜ê³  êµ¶ì–´ì£½ëŠ” ìƒí™©ì´ë‹¤.

ë§¤ìš° ë“œë¬¼ê²Œ ë™ì‹œì— ëª¨ë“  ì² í•™ìê°€ ì™¼ìª½ ì “ê°€ë½ì„ ì§‘ì—ˆë‹¤ê³  í•˜ë©´, 5ëª…ì˜ ì² í•™ìê°€ 5ê°œì˜ ì “ê°€ë½ì„ ëª¨ë‘ ì§‘ì–´ë“  ìƒí™©ì´ë‹¤. ê·¸ ê²°ê³¼ ë‚¨ì•„ìˆëŠ” ì “ê°€ë½ì€ ë” ì´ìƒ ì—†ê³  ëª¨ë“  ì² í•™ìê°€ ë°˜ëŒ€í¸ ì “ê°€ë½ì„ ë“¤ê¸° ìœ„í•´ ê¸°ë‹¤ë¦¬ê³  ìˆë‹¤. í•˜ì§€ë§Œ ì‹ì‚¬í•  ìˆ˜ ìˆëŠ” ì² í•™ìëŠ” ì•„ë¬´ë„ ì—†ìœ¼ë¯€ë¡œ ì•„ë¬´ë„ ì “ê°€ë½ì„ ë‚´ë ¤ë†“ì§€ ì•Šê³  ê¸°ë‹¤ë¦¬ê²Œ ëœë‹¤.

ì´ëŸ¬í•œ ìƒí™©ì„ **êµì°©ìƒíƒœ(deadlock)**ë¼ê³  í•œë‹¤.



### 5. Deadlock (êµì°© ìƒíƒœ)

í”„ë¡œì„¸ìŠ¤ëŠ” ì‹¤í–‰ì„ ìœ„í•´ CPU, ë©”ëª¨ë¦¬, íŒŒì¼ ë“± ì—¬ëŸ¬ í•˜ë“œì›¨ì–´ ìì›ì´ í•„ìš”í•˜ë‹¤. ìš´ì˜ì²´ì œì—ì„œëŠ” í”„ë¡œì„¸ìŠ¤ê°€ ìš”êµ¬í•˜ëŠ” ìì›ì„ ì ì ˆíˆ ë¶„ë°°í•´ì¤€ë‹¤. ex. í•œ í”„ë¡œì„¸ìŠ¤ê°€ A ìì›ì„ ê°€ì§€ê³  ìˆëŠ” ìƒíƒœì—ì„œ B ìì›ì„ ìš”êµ¬í•œë‹¤. í•˜ì§€ë§Œ, B ìì›ì€ ë‹¤ë¥¸ í”„ë¡œì„¸ìŠ¤ ì—­ì‹œ ìš”êµ¬í•˜ê³  ìˆëŠ” ìì›ì´ë‹¤. ì´ëŸ° ìƒí™©ì—ì„œ ìì›ì„ ë¶„ë°°í•˜ëŠ” ìˆœì„œê°€ ì˜ëª»ë˜ë©´ êµì°©ìƒíƒœì— ë¹ ì§•ê²Œ ëœë‹¤.



#### 5 - 1. êµì°©ìƒíƒœ í•„ìš” ì¡°ê±´ (Necessary Conditions)

í•„ìš” ì¡°ê±´ -> ë„¤ ê°€ì§€ê°€ ëª¨ë‘ í•´ë‹¹ëœë‹¤ê³  í•´ì„œ ë°˜ë“œì‹œ êµì°©ìƒíƒœê°€ ì¼ì–´ë‚˜ëŠ” ê²ƒì€ ì•„ë‹ˆê³ , ì¼ì–´ë‚  í™•ë¥ ì´ ìƒê¸´ë‹¤.

- **Mutual exclusion (ìƒí˜¸ë°°íƒ€)**: í•œ í”„ë¡œì„¸ìŠ¤ê°€ ìì›ì„ ì‚¬ìš©í•˜ê³  ìˆë‹¤ë©´, ë‹¤ë¥¸ í”„ë¡œì„¸ìŠ¤ëŠ” ì´ ìì›ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤.
  \- ì “ê°€ë½ì€ í•œ ì² í•™ìê°€ ì‚¬ìš©í•˜ê³  ìˆìœ¼ë©´ ì´ ì “ê°€ë½ì€ ì‚¬ìš©í•  ìˆ˜ ì—†ìœ¼ë¯€ë¡œ ìƒí˜¸ë°°íƒ€ì ì´ë‹¤.
- **Hold and wait (ë³´ìœ  ë° ëŒ€ê¸°)**: í•œ í”„ë¡œì„¸ìŠ¤ê°€ ìì›ì„ ê°€ì§€ê³  ìˆëŠ” ìƒíƒœì—ì„œ ëŒ€ê¸°í•œë‹¤.
  \- ì² í•™ìëŠ” ì™¼ìª½ ì “ê°€ë½ì„ ê°€ì§€ê³  ìˆëŠ” ìƒíƒœì—ì„œ ì˜¤ë¥¸ìª½ ì “ê°€ë½ì„ ì§‘ê¸° ìœ„í•´ ëŒ€ê¸°í•œë‹¤.
- **No Preemption (ë¹„ì„ ì )**: í•œ í”„ë¡œì„¸ìŠ¤ê°€ ìì›ì„ ìˆ˜í–‰í•˜ëŠ” ì¤‘ì—ëŠ” ë‹¤ë¥¸ í”„ë¡œì„¸ìŠ¤ê°€ ì¤‘ê°„ì— ë¼ì–´ë“¤ ìˆ˜ ì—†ë‹¤.
  \- í•œ ì² í•™ìê°€ ì “ê°€ë½ì„ ì§‘ì€ ìƒíƒœì—ì„œ ë‹¤ë¥¸ ì² í•™ìê°€ ì´ ì “ê°€ë½ì„ ëºì„ ìˆ˜ ì—†ë‹¤.
- **Circular wait (í™˜í˜•ëŒ€ê¸°)**: í”„ë¡œì„¸ìŠ¤ê°€ ìš”êµ¬í•˜ëŠ” ìì›ì˜ ë°©í–¥ì´ ì›í˜•ì„ ì´ë£¬ë‹¤.
  \- ëª¨ë“  ì² í•™ìëŠ” ì™¼ìª½ ì “ê°€ë½ë¶€í„° ì§‘ì„ ìˆ˜ ìˆë‹¤.

êµì°©ìƒíƒœëŠ” ìœ„ ë„¤ ê°€ì§€ ì¡°ê±´ì„ ëª¨ë‘ ë§Œì¡±í•˜ë”ë¼ë„ ë§¤ìš° ë“œë¬¼ê²Œ ì¼ì–´ë‚˜ëŠ” í˜„ìƒì´ì§€ë§Œ, í•œ ë²ˆ êµì°©ìƒíƒœì— ë¹ ì§€ë©´ í”„ë¡œì„¸ìŠ¤ê°€ ë¬´í•œ ë£¨í”„ì— ë¹ ì ¸ ìˆ˜í–‰ë˜ì§€ ëª»í•œë‹¤. 



#### 5 - 2. ìì› (Resources)

í•˜ë“œì›¨ì–´ ìì›ì€ ì—¬ëŸ¬ ê°œê°€ ì¡´ì¬í•˜ê³  ë™ì¼í•œ í˜•ì‹(type)ì˜ ìì›ì´ ì¡´ì¬í•  ìˆ˜ ìˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ê°™ì€ CPUê°€ 2ê°œìˆëŠ” í™˜ê²½ì´ ìˆë‹¤. ì´ëŸ¬í•œ ìì› í•˜ë‚˜í•˜ë‚˜ë¥¼ instanceë¼ê³  í•œë‹¤.

ìì›ì€ í”„ë¡œì„¸ìŠ¤ê°€ ì§ì ‘ì ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ì—†ê³ , ìš´ì˜ì²´ì œì— **ìš”ì²­(request)**í•˜ë©´ ìš´ì˜ì²´ì œê°€ ì œê³µí•´ì¤€ë‹¤. ê·¸ í›„ í”„ë¡œì„¸ìŠ¤ëŠ” ì´ ìì›ì„ **ì‚¬ìš©(use)**í•˜ê³  ëª¨ë“  ì‚¬ìš©ì´ ëë‚˜ë©´ ì´ë¥¼ **ë°˜ë‚©(release)**í•œë‹¤.



##### ìì› í• ë‹¹ë„(Resource Allocation Graph)

ì–´ë–¤ ìì›ì´ ì–´ë–¤ í”„ë¡œì„¸ìŠ¤ì— í• ë‹¹ë˜ì—ˆëŠ”ì§€ ë˜ëŠ” ì–´ëŠ í”„ë¡œì„¸ìŠ¤ê°€ ì–´ëŠ ìì›ì„ í• ë‹¹ ë°›ìœ¼ë ¤ê³  ê¸°ë‹¤ë¦¬ëŠ”ì§€ë¥¼ **ê·¸ë¦¼**ìœ¼ë¡œ ë‚˜íƒ€ë‚¸ ê²ƒ

![img](https://user-images.githubusercontent.com/34755287/54337395-1f7ccf00-4672-11e9-8553-eeeb75b665a2.png)

- ìì›: ì‚¬ê°í˜•
- Instance: ì 
- í”„ë¡œì„¸ìŠ¤ : ì›
- í• ë‹¹ : í™”ì‚´í‘œ

ìì› í• ë‹¹ë„ë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ìœ ëŠ” êµì°©ìƒíƒœì˜ í•„ìš”ì¡°ê±´ì„ í•œ ëˆˆì— ë³¼ ìˆ˜ ìˆê¸° ë•Œë¬¸. ìì› í• ë‹¹ë„ë¥¼ ë¶„ì„í•  ë•Œ **mutual exclusionê³¼ no-preemptionì€ ê¸°ë³¸ìœ¼ë¡œ ì ìš©**ëœë‹¤.

![img](https://user-images.githubusercontent.com/34755287/54337397-1f7ccf00-4672-11e9-8386-698a4db14e43.png)

**Hold and Wait**: í•œ í”„ë¡œì„¸ìŠ¤ê°€ ì¸ìŠ¤í„´ìŠ¤ë¥¼ í• ë‹¹ë°›ì•˜ê³ , ë‹¤ë¥¸ ìì›ì„ ê°€ë¦¬í‚¤ê³  ìˆë‹¤ë©´, ì´ ìƒí™©ì€ Hold and Wait ìƒíƒœì´ë‹¤.

**Circular Wait**: í™”ì‚´í‘œ ë°©í–¥ì´ ì›í˜•ì„ ì´ë£¨ê³  ìˆë‹¤ë©´ í™˜í˜•ëŒ€ê¸° ìƒíƒœì´ë‹¤.

ìœ„ì˜ ê·¸ë¦¼ì€ **ì‹ì‚¬í•˜ëŠ” ì² í•™ì ë¬¸ì œë¥¼ ìì›í• ë‹¹ë„ë¡œ í‘œí˜„**í•œ ê²ƒ. 

=> Circular Wait, Hold and Wait ì¡°ê±´ì„ ëª¨ë‘ ë§Œì¡±



=> Circular ì¡°ê±´ì„ ì—†ì• ê¸° ìœ„í•´ ì§ìˆ˜ ë²ˆí˜¸ ì² í•™ìëŠ” ì™¼ìª½ ì “ê°€ë½ë¶€í„°, í™€ìˆ˜ ë²ˆí˜¸ ì² í•™ìëŠ” ì˜¤ë¥¸ìª½ ì “ê°€ë½ë¶€í„° ì§‘ëŠ”ë‹¤.

![img](https://user-images.githubusercontent.com/34755287/54337399-20156580-4672-11e9-9b44-a784e582ba54.png)

```java
// Philosopher Thread run function
public void run() {
    try {
        while (true) {
            if (id % 2 == 0) {
                lstick.acquire();
                rstick.acquire();
            }
            else {
                rstick.acquire();
                lstick.acquire();
            }
            eating();
            lstick.release();
            rstick.release();
            thinking();
        }
    }catch (InterruptedException e) { }
}
```



#### 5 - 3. êµì°©ìƒíƒœ ì²˜ë¦¬

##### êµì°©ìƒíƒœ ë°©ì§€ (Deadlock Prevention)

 êµì°©ìƒíƒœ í•„ìš”ì¡°ê±´ ë„¤ ê°€ì§€ ì¤‘ ìµœì†Œ í•œ ê°€ì§€ë¥¼ ë§Œì¡±ì‹œí‚¤ì§€ ì•Šë„ë¡ ë§Œë“œëŠ” ê²ƒ

- **ìƒí˜¸ë°°íƒ€(Mutual exclusion)**: ìƒí˜¸ë°°íƒ€ë¥¼ ì—†ì• ê¸° ìœ„í•´ì„œëŠ” ìì›ì„ **ê³µìœ  ê°€ëŠ¥**í•˜ê²Œ ë§Œë“¤ì–´ì•¼ í•œë‹¤. í•˜ì§€ë§Œ í˜„ì‹¤ì ìœ¼ë¡œ ì´ëŸ¬í•œ ë°©ë²•ì´ **ë¶ˆê°€ëŠ¥**í•œ ê²½ìš°ê°€ ë§ë‹¤.
- **ë³´ìœ  ë° ëŒ€ê¸°(Hold & Wait)**: ì´ ì¡°ê±´ì„ ì—†ì• ë ¤ë©´ ìì›ì„ ê°€ì§€ê³  ìˆëŠ” ìƒíƒœì—ì„œ ë‹¤ë¥¸ ìì›ì„ ê¸°ë‹¤ë¦¬ì§€ ì•Šë„ë¡ ë§Œë“ ë‹¤. ë§Œì•½ ì—¬ëŸ¬ ê°œì˜ ìì›ì´ í•„ìš”í•˜ë‹¤ë©´ **í•„ìš”í•œ ëª¨ë“  ìì›ì„ ì–»ì„ ìˆ˜ ìˆëŠ” ê²½ìš°ì—ë§Œ í•´ë‹¹ ìì›ì„ ìš”ì²­**í•œë‹¤. ë˜ëŠ” í•„ìš”í•œ ìì› ì¤‘ ì¼ë¶€ë§Œ ê°€ì§€ëŠ” ê²½ìš° í• ë‹¹ë°›ì€ ìì›ì„ ëª¨ë‘ ìš´ì˜ì²´ì œì— ë°˜ë‚©í•œë‹¤. í•˜ì§€ë§Œ ì´ì™€ ê°™ì€ ë°©ë²•ì€ ìì›ì˜ **í™œìš©ë¥ ì„ ì €í•˜ì‹œí‚¤ê³ , starvation í˜„ìƒì´ ë°œìƒí•˜ëŠ” ë‹¨ì **ì´ ìˆë‹¤.
- **ë¹„ì„ ì (No preemption)**: ë¹„ì„ ì ì„ ì—†ì• ëŸ¬ë©´ ë°˜ëŒ€ë¡œ **ì„ ì ì´ ê°€ëŠ¥í•˜ë„ë¡** ë§Œë“¤ì–´ì•¼ í•œë‹¤. ì´ ì—­ì‹œ ëŒ€ë¶€ë¶„ì˜ ìì›ì—ê²ŒëŠ” **ë¶ˆê°€ëŠ¥**í•œ ë°©ë²•ì´ë‹¤. CPUëŠ” ê°•ì œë¡œ ìŠ¤ìœ„ì¹­í•˜ëŠ” ê²ƒì´ ê°€ëŠ¥í•œ ê²½ìš°ê°€ ìˆì§€ë§Œ, ëŒ€ë¶€ë¶„ì˜ ê²½ìš°ì—ëŠ” ë¶ˆê°€ëŠ¥í•˜ë‹¤. ê°€ë ¹ í”„ë¦°í„°ë¥¼ ìˆ˜í–‰í•˜ëŠ” ì¤‘ê°„ì— ë‹¤ë¥¸ í”„ë¡œì„¸ìŠ¤ê°€ ì´ë¥¼ ì„ ì í•˜ëŠ” ê²ƒì€ ë¶ˆê°€ëŠ¥í•˜ë‹¤ê³  ë³¼ ìˆ˜ ìˆë‹¤.
- **í™˜í˜•ëŒ€ê¸°(Circular wait)**: ì´ ì¡°ê±´ì„ ì—†ì• ëŠ” ê²ƒì€ ìœ„ ì„¸ ê°€ì§€ ì¡°ê±´ë³´ë‹¤ëŠ” í•  ìˆ˜ ìˆëŠ” í™•ë¥ ì´ ë†’ë‹¤. ëŒ€í‘œì ì¸ ì˜ˆëŠ” ëª¨ë“  ìì›ì— ë²ˆí˜¸ë¥¼ ë¶€ì—¬í•˜ì—¬ ì´ ë²ˆí˜¸ì— ëŒ€í•œ **ì˜¤ë¦„ì°¨ìˆœ**ìœ¼ë¡œ ìì›ì„ ìš”ì²­í•˜ëŠ” ê²ƒì´ë‹¤. ì´ ì—­ì‹œ **ìì›ì˜ í™œìš©ë¥ ì„ ì €í•˜**ì‹œí‚¤ëŠ” ë‹¨ì ì´ ìˆë‹¤.

ë„¤ ê°€ì§€ ë°©ë²•ì„ ì‚´í´ë³¸ ê²°ê³¼ ê°€ì¥ í˜„ì‹¤ì ì¸ ë°©ë²•ì€ **hold & waitë‚˜ circular wait ì¡°ê±´ì„ ì—†ì• ëŠ” ê²ƒ**ì´ë‹¤.

í•˜ì§€ë§Œ ë‘˜ ë‹¤ ìì›ì„ ë¹„íš¨ìœ¨ì ìœ¼ë¡œ ì‚¬ìš©í•˜ê²Œ ë˜ëŠ” ë‹¨ì ì„ ê°€ì§€ê³  ìˆë‹¤. ê·¸ë˜ì„œ ì´ì™€ ê°™ì´ êµì°©ìƒíƒœë¥¼ ì‚¬ì „ì— ë°©ì§€í•˜ëŠ” ê²ƒì€ êµ°ì‚¬, ìš°ì£¼, ì˜ë£Œì™€ ê°™ì€ í¬ë¦¬í‹°ì»¬í•œ ê³³ì—ì„œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.



##### êµì°©ìƒíƒœ íšŒí”¼ (Deadlock Avoidance)

êµì°©ìƒíƒœ íšŒí”¼ì™€ ë°©ì§€ì˜ ì°¨ì´ì ì€ êµì°©ìƒíƒœë¥¼ ë‹¤ë¥´ê²Œ ì ‘ê·¼í•˜ëŠ” ê²ƒì´ë‹¤. êµì°©ìƒíƒœ íšŒí”¼ì—ì„œëŠ” êµì°©ìƒíƒœë¥¼ **ìì› ìš”ì²­ì— ëŒ€í•œ ì˜ëª»ëœ ìŠ¹ì¸**ìœ¼ë¡œ íŒë‹¨í•œë‹¤. => ë”°ë¼ì„œ **ì•ˆì „í•œ í• ë‹¹ (Safe allocation)**ê³¼ **ë¶ˆì•ˆì •í•œ í• ë‹¹ (Unsafe allocaion)** ë‘ ê°€ì§€ë¡œ ë‚˜ë‰œë‹¤.



#### ì•ˆì „í•œ í• ë‹¹

í˜„ì¬ ìš´ì˜ì²´ì œì—ëŠ” magnetic tape ìì›ì´ ì´ 12ê°œê°€ ìˆê³ , ì´ë¥¼ ìš”ì²­í•˜ëŠ” 3ê°œì˜ í”„ë¡œì„¸ìŠ¤ê°€ ìˆë‹¤.

| Process | Max needs | Current needs |
| ------- | --------- | ------------- |
| P0      | 10        | 5             |
| P1      | 4         | 2             |
| P2      | 9         | 2             |

3ê°œì˜ í”„ë¡œì„¸ìŠ¤ê°€ ìš”ì²­í•˜ëŠ” magnetic tapeì˜ ì–‘ì€ ìœ„ í‘œì™€ ê°™ë‹¤. Current needsëŠ” í•œ í”„ë¡œì„¸ìŠ¤ê°€ í•œ ë²ˆ ìš”ì²­ì„ í•  ë•Œ ìš”êµ¬í•˜ëŠ” ê°œìˆ˜ì´ê³ , Max needsëŠ” í”„ë¡œì„¸ìŠ¤ë¥¼ ì •ìƒì ìœ¼ë¡œ ëë‚´ê¸° ìœ„í•´ í•„ìš”í•œ ì´ ê°œìˆ˜ì´ë‹¤. ìš´ì˜ì²´ì œ ì…ì¥ì—ì„œ 3ê°œì˜ í”„ë¡œì„¸ìŠ¤ê°€ ëª¨ë‘ ìˆ˜í–‰ë  ë•Œê¹Œì§€ ìì›ì„ ë¶„ë°°í•´ë³´ì.

- P0ì—ê²Œ 5ê°œë¥¼ í• ë‹¹í•œë‹¤.(5/10) => í˜„ì¬ magnetic tape ê°œìˆ˜: 7
- P1ì—ê²Œ 2ê°œë¥¼ í• ë‹¹í•œë‹¤.(2/4) => í˜„ì¬ magnetic tape ê°œìˆ˜: 5
- P2ì—ê²Œ 2ê°œë¥¼ í• ë‹¹í•œë‹¤.(2/9) => í˜„ì¬ magnetic tape ê°œìˆ˜: 3
- ë‹¤ì‹œ P0ê°€ 5ê°œë¥¼ ìš”êµ¬í•˜ì§€ë§Œ í˜„ì¬ magnetic tape ê°œìˆ˜ëŠ” 3ê°œì´ë¯€ë¡œ í• ë‹¹í•´ì¤„ ìˆ˜ ì—†ë‹¤.
- P1ì—ê²Œ 2ê°œë¥¼ í• ë‹¹í•œë‹¤.(4/4) => í˜„ì¬ magnetic tape ê°œìˆ˜: 1
- P1ì€ í•„ìš”í•œ 4ê°œì˜ magnetic tapeì„ ë°›ì•˜ìœ¼ë¯€ë¡œ, ì •ìƒì ìœ¼ë¡œ í”„ë¡œì„¸ìŠ¤ë¥¼ ì¢…ë£Œí•˜ê³  ì‚¬ìš©í•œ ìì›ì„ ë°˜ë‚©í•œë‹¤. => í˜„ì¬ magnetic tape ê°œìˆ˜: 5
- ëŒ€ê¸°í•˜ê³  ìˆë˜ P0ì—ê²Œ 5ê°œë¥¼ í• ë‹¹í•œë‹¤.(10/10) => í˜„ì¬ magnetic tape ê°œìˆ˜: 0
- P0 ì—­ì‹œ í•„ìš”í•œ ìì›ì„ ëª¨ë‘ í• ë‹¹ë°›ì•˜ìœ¼ë¯€ë¡œ, ì¢…ë£Œ í›„ ìì›ì„ ë°˜ë‚©í•œë‹¤. => í˜„ì¬ magnetic tape ê°œìˆ˜: 10
- P2ëŠ” í˜„ì¬ í•„ìš”í•œ magnetic tape ê°œìˆ˜ê°€ 7ê°œì´ê³ , í˜„ì¬ ë‚¨ì•„ìˆëŠ” magnetic tape ê°œìˆ˜ 10ê°œì´ë¯€ë¡œ ì •ìƒì ìœ¼ë¡œ ìˆ˜í–‰ê°€ëŠ¥í•˜ë‹¤.

ì´ ì˜ˆì œì—ì„œëŠ” 3ê°œì˜ í”„ë¡œì„¸ìŠ¤ê°€ ëª¨ë‘ ì •ìƒì ìœ¼ë¡œ ìì›ì„ í• ë‹¹ë°›ê³  ì¢…ë£Œí•  ìˆ˜ ìˆì—ˆë‹¤. ì´ë¥¼ ì•ˆì „í•œ í• ë‹¹ì´ë¼ í•œë‹¤. 



#### ë¶ˆì•ˆì „í•œ í• ë‹¹

| Process | Max needs | Current needs |
| ------- | --------- | ------------- |
| P0      | 10        | 5             |
| P1      | 4         | 2             |
| P2      | 9         | 3             |

ì´ ì˜ˆì œ ì—­ì‹œ ìš´ì˜ì²´ì œê°€ ë³´ìœ í•˜ê³  ìˆëŠ” ì´ magnetic tape ê°œìˆ˜ëŠ” 12ê°œì´ê³ , 3ê°œì˜ í”„ë¡œì„¸ìŠ¤ê°€ ì¡´ì¬í•œë‹¤. ìì›ì„ ë¶„ë°°í•´ë³´ì.

- P0ì—ê²Œ 5ê°œë¥¼ í• ë‹¹í•œë‹¤.(5/10) => í˜„ì¬ magnetic tape ê°œìˆ˜: 7
- P1ì—ê²Œ 2ê°œë¥¼ í• ë‹¹í•œë‹¤.(2/4) => í˜„ì¬ magnetic tape ê°œìˆ˜: 5
- P2ì—ê²Œ 3ê°œë¥¼ í• ë‹¹í•œë‹¤.(3/9) => í˜„ì¬ magnetic tape ê°œìˆ˜: 2
- ë‹¤ì‹œ P0ê°€ 5ê°œë¥¼ ìš”êµ¬í•˜ì§€ë§Œ í˜„ì¬ magnetic tape ê°œìˆ˜ëŠ” 2ê°œì´ë¯€ë¡œ í• ë‹¹í•´ì¤„ ìˆ˜ ì—†ë‹¤.
- P1ì—ê²Œ 2ê°œë¥¼ í• ë‹¹í•œë‹¤.(4/4) => í˜„ì¬ magnetic tape ê°œìˆ˜: 0
- P1ì€ í•„ìš”í•œ ìì›ì„ ëª¨ë‘ í• ë‹¹ë°›ì•˜ìœ¼ë¯€ë¡œ, ì •ìƒì ìœ¼ë¡œ í”„ë¡œì„¸ìŠ¤ë¥¼ ì¢…ë£Œí•˜ê³  ì‚¬ìš©í•œ ìì›ì„ ë°˜ë‚©í•œë‹¤. => í˜„ì¬ magnetic tape ê°œìˆ˜: 4
- ëŒ€ê¸°í•˜ê³  ìˆë˜ P0ëŠ” ì•„ì§ í• ë‹¹ë°›ìœ¼ë¥´ ìˆ˜ ì—†ë‹¤.
- P2ì—ê²Œ 3ê°œë¥¼ í• ë‹¹í•œë‹¤.(6/9) => í˜„ì¬ magnetic tape ê°œìˆ˜: 1
- í˜„ì¬ ë‚¨ì•„ìˆëŠ” magnetic tape ê°œìˆ˜ëŠ” 1ê°œì´ê³ , P0ê°€ ìš”êµ¬í•˜ëŠ” ê°œìˆ˜ëŠ” 5ê°œ, P2ëŠ” 3ê°œì´ë¯€ë¡œ ë‘ í”„ë¡œì„¸ìŠ¤ ëª¨ë‘ í• ë‹¹ë°›ì„ ìˆ˜ ì—†ë‹¤.

ì´ ì˜ˆì œì—ì„œ ë‚¨ì€ magnetic tape ê°œìˆ˜ê°€ ìš”êµ¬í•˜ëŠ” ê°œìˆ˜ë³´ë‹¤ ì ìœ¼ë¯€ë¡œ ìì›ì„ í• ë‹¹í•´ì¤„ ìˆ˜ ì—†ë‹¤. ê·¸ëŸ¬ë¯€ë¡œ P0, P2 í”„ë¡œì„¸ìŠ¤ëŠ” ìì›ì„ í•˜ì—¼ì—†ì´ ê¸°ë‹¤ë¦¬ê²Œ ëœë‹¤. ì´ë¥¼ **ë¶ˆì•ˆì „í•œ í• ë‹¹ì´ë¼ í•˜ê³ , ê·¸ ê²°ê³¼ êµì°©ìƒíƒœì— ë¹ ì§€ê²Œ ëœë‹¤.**

êµì°©ìƒíƒœ íšŒí”¼ëŠ” ë§ˆì¹˜ ëŒ€ì¶œì „ë¬¸ ì€í–‰ê³¼ ìœ ì‚¬í•˜ê²Œ ë™ì‘í•˜ë¯€ë¡œ, í•´ê²° ë°©ë²•ì„ **Banker's Algorithm**ì´ë¼ í•œë‹¤.



##### êµì°©ìƒíƒœ ê²€ì¶œ ë° ë³µêµ¬ (Deadlock Detection & Recovery)

êµì°©ìƒíƒœ ê²€ì¶œ ë° ë³µêµ¬ ë°©ë²•ì€ êµì°©ìƒíƒœê°€ ì¼ì–´ë‚˜ëŠ” ê²ƒì„ í—ˆìš©. ê·¸ ëŒ€ì‹ , êµì°©ìƒíƒœê°€ ì¼ì–´ë‚¬ì„ ë•Œ ì´ë¥¼ ì¸ì§€í•˜ê³  ë³µêµ¬í•´ì•¼ í•œë‹¤.

êµì°©ìƒíƒœê°€ ì¼ì–´ë‚˜ëŠ” ê²ƒì„ ê°ì§€í•˜ê¸° ìœ„í•´ ìš´ì˜ì²´ì œ ë‚´ë¶€ì—ì„œ **ì£¼ê¸°ì ìœ¼ë¡œ êµì°©ìƒíƒœê°€ ë°œìƒí•˜ì˜€ëŠ”ì§€ ê²€ì‚¬**í•´ì•¼í•œë‹¤.

ê·¸ ì£¼ê¸°ì˜ ê¸¸ì´ê°€ ì§§ìœ¼ë©´ ê·¸ ë§Œí¼ ì˜¤ë²„í—¤ë“œê°€ í¬ê³ , ì£¼ê¸°ê°€ ê¸¸ë©´ ì˜¤ë²„í—¤ë“œëŠ” ì¤„ì¼ ìˆ˜ ìˆì§€ë§Œ ë³µêµ¬ ê°€ëŠ¥ì„±ì´ ë‚®ì•„ì§„ë‹¤. 

ë³µêµ¬í•˜ëŠ” ë°©ë²•ì€ êµì°©ìƒíƒœê°€ ë°œìƒí•˜ëŠ”ì§€ ì£¼ê¸°ì ìœ¼ë¡œ ê²€ì‚¬í•˜ë“¯ì´ **ë©”ëª¨ë¦¬ì˜ ìƒíƒœë¥¼ ì£¼ê¸°ì ìœ¼ë¡œ ë©”ëª¨ë¦¬ì— ì €ì¥í•´ë†“ê³  ë§Œì•½ êµì°©ìƒíƒœê°€ ë°œìƒí•˜ë©´ ê·¸ ì´ì „ ìƒíƒœë¡œ ë˜ëŒë¦¬ëŠ” ë°©ë²•**ì´ ìˆë‹¤. ê·¸ ì™¸ì—ë„ **ì¼ë¶€ í”„ë¡œì„¸ìŠ¤ë¥¼ ê°•ì œë¡œ ì¢…ë£Œ**í•˜ê±°ë‚˜ **ìì›ì„ ê°•ì œë¡œ ì„ ì **í•˜ì—¬ í”„ë¡œì„¸ìŠ¤ì—ê²Œ í• ë‹¹í•´ì£¼ëŠ” ë°©ë²• ë“±ì´ ìˆë‹¤.

êµì°©ìƒíƒœ ê²€ì¶œ ë° ë³µêµ¬ëŠ” êµì°©ìƒíƒœ ìì²´ê°€ ë§¤ìš° ë“œë¬¸ í˜„ìƒì´ë¯€ë¡œ ììœ ë¡­ê²Œ ìì›ì„ ë¶„ë°°í•˜ë‹¤ê°€ êµì°©ìƒíƒœê°€ ë°œìƒí•˜ë©´ ì´ë¥¼ ì •ìƒì ì¸ ìƒíƒœë¡œ ë³µêµ¬í•˜ëŠ” ê²ƒì´ë‹¤. í•˜ì§€ë§Œ ë³µêµ¬ë¥¼ ì œëŒ€ë¡œ í•˜ì§€ ëª»í•  ìˆ˜ë„ ìˆê³ , ê²€ì¶œì„ ìœ„í•´ ì¶”ê°€ì ì¸ ì˜¤ë²„í—¤ë“œê°€ ë°œìƒí•œë‹¤ëŠ” ë‹¨ì ì´ ìˆë‹¤.



##### êµì°©ìƒíƒœ ë¬´ì‹œ

êµì°©ìƒíƒœì˜ í•„ìš”ì¡°ê±´ ë„¤ ê°€ì§€ë¥¼ ëª¨ë‘ ë§Œì¡±í•˜ë”ë¼ë„ êµì°©ìƒíƒœê°€ ë°˜ë“œì‹œ ì¼ì–´ë‚˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ê³  í–ˆë“¯ì´, **êµì°©ìƒíƒœëŠ” ë§¤ìš° ë“œë¬¸ ìƒí™©**ì´ë‹¤. ê·¸ëŸ¬ë¯€ë¡œ ì´ë¥¼ ìœ„í•´ **ì˜¤ë²„í—¤ë“œë¥¼ ê°ìˆ˜í•˜ëŠ” ê²ƒì´ ë¹„íš¨ìœ¨ì ì¸ í™˜ê²½ë„ ì¡´ì¬**í•œë‹¤. ê·¸ëŸ¬í•œ í™˜ê²½ì€ êµì°©ìƒíƒœì— ëŒ€í•œ ì•„ë¬´ëŸ° ì¡°ì¹˜ë¥¼ í•˜ì§€ ì•ŠëŠ” ë°©ë²•ë„ ìˆë‹¤.





---

#### Q. ìš´ì˜ì²´ì œì—ì„œ ê¸°ì•„(starvation)ë€?

íŠ¹ì • í”„ë¡œì„¸ìŠ¤ì˜ ìš°ì„ ìˆœìœ„ê°€ ë‚®ì•„ì„œ ì›í•˜ëŠ” ìì›ì„ ê³„ì† í• ë‹¹ ë°›ì§€ ëª»í•˜ëŠ” ìƒíƒœì´ë‹¤.

ê¸°ì•„ìƒíƒœëŠ” ìì› ê´€ë¦¬ ë¬¸ì œì´ë‹¤. ì´ ë¬¸ì œì—ì„œ ëŒ€ê¸°ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤ëŠ” ë¦¬ì†ŒìŠ¤ê°€ ë‹¤ë¥¸ í”„ë¡œì„¸ìŠ¤ì— í• ë‹¹ë˜ì–´ ìˆê¸° ë•Œë¬¸ì— ì˜¤ë«ë™ì•ˆ í•„ìš”í•œ ë¦¬ì†ŒìŠ¤ë¥¼ ì–»ì§€ ëª»í•œë‹¤.



#### Q. ë®¤í…ìŠ¤ì™€ ì„¸ë§ˆí¬ì–´ì˜ ì°¨ì´

A. Mutex: ë°©ì´ í•˜ë‚˜ ë¿ì´ ì—†ìŒ. ë°©ì´ ì ìœ ë˜ì–´ ìˆë‹¤ë©´ ë‹¤ë¥¸ ì‚¬ëŒë“¤ì€ ê³„ì†í•´ì„œ ëŒ€ê¸°í•´ì•¼ í•œë‹¤. ë°©ì„ ì´ìš©í•˜ëŠ” ì‚¬ëŒì€ **í”„ë¡œì„¸ìŠ¤ í˜¹ì€ ì“°ë ˆë“œ**ì´ë©° ë°©ì€ **ê³µìœ ìì›**ì´ë‹¤. ë®¤í…ìŠ¤ëŠ” Keyì— í•´ë‹¹í•˜ëŠ” ì–´ë–¤ ì˜¤ë¸Œì íŠ¸ê°€ ìˆìœ¼ë©° ì´ ì˜¤ë¸Œì íŠ¸ë¥¼ ì†Œìœ í•œ (ì“°ë ˆë“œ, í”„ë¡œì„¸ìŠ¤)ë§Œì´ ê³µìœ ìì›ì— ì ‘ê·¼í•  ìˆ˜ ìˆë‹¤.

â€‹    Semaphore: ì—¬ëŸ¬ ê°œì˜ ë°©ì´ ìˆê³ , ë¹ˆ ë°©ì˜ ê°œìˆ˜ë¥¼ ë³´ì—¬ì£¼ëŠ” ì „ê´‘íŒì´ ìˆìŒ. ì–´ë–¤ ì‚¬ëŒì´ ë°©ì— ë“¤ì–´ê°€ê¸° ìœ„í•´ ì…êµ¬ì—ì„œ ë¹ˆ ë°©ì˜ ê°œìˆ˜ë¥¼ í™•ì¸í•˜ê³  ë¹ˆ ë°©ì´ 1ê°œ ì´ìƒì´ë¼ë©´ ë¹ˆ ë°©ì˜ ê°œìˆ˜ë¥¼ í•˜ë‚˜ ë¹¼ê³  ë°©ì— ë“¤ì–´ê°„ë‹¤. ê·¸ë¦¬ê³  ë‚˜ì˜¬ ë•Œ í•˜ë‚˜ ë”í•´ì¤€ë‹¤. ëª¨ë“  ë°©ì— ì‚¬ëŒì´ ë“¤ì–´ê°”ì„ ë•Œ ë¹ˆ ë°©ì˜ ê°œìˆ˜ëŠ” 0ì´ ë˜ë©°, ì´ ë•Œ ë°©ì— ë“¤ì–´ê°€ê³ ì í•˜ëŠ” ì‚¬ëŒì´ ìˆë‹¤ë©´ ë¹ˆ ë°©ì˜ ê°œìˆ˜ê°€ 1ë¡œ ë°”ë€” ë•Œê¹Œì§€ ê¸°ë‹¤ë ¤ì•¼ í•œë‹¤. ì„¸ë§ˆí¬ì–´ë„ ë°©ì€ **ê³µìœ ìì›**ì´ë©° ì‚¬ëŒë“¤ì€ **ì“°ë ˆë“œ, í”„ë¡œì„¸ìŠ¤**ì´ë‹¤. ë¹ˆ ë°©ì˜ ê°œìˆ˜ëŠ” **í˜„ì¬ ê³µìœ ìì›ì— ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ì“°ë ˆë“œ, í”„ë¡œì„¸ìŠ¤ì˜ ê°œìˆ˜**ì´ë‹¤.

**ë®¤í…ìŠ¤**: í•œ ì“°ë ˆë“œ, í”„ë¡œì„¸ìŠ¤ì— ì˜í•´ ì†Œìœ ë  ìˆ˜ ìˆëŠ” **Key**ğŸ”‘ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•œ ìƒí˜¸ë°°ì œê¸°ë²•

**ì„¸ë§ˆí¬ì–´**: Signaling mechanism. í˜„ì¬ ê³µìœ ìì›ì— ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ì“°ë ˆë“œ, í”„ë¡œì„¸ìŠ¤ì˜ ìˆ˜ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ê°’ì„ ë‘ì–´ ìƒí˜¸ë°°ì œë¥¼ ë‹¬ì„±í•˜ëŠ” ê¸°ë²•

- ê°€ì¥ í° ì°¨ì´ì ì€ ê´€ë¦¬í•˜ëŠ” ë™ê¸°í™” ëŒ€ìƒì˜ ê°œìˆ˜
- SemaphoreëŠ” Mutexê°€ ë  ìˆ˜ ìˆì§€ë§Œ MutexëŠ” Semaphoreê°€ ë  ìˆ˜ ì—†ë‹¤.
- MutexëŠ” Mutexë¥¼ ì†Œìœ í•˜ê³  ìˆëŠ” ì“°ë ˆë“œê°€ ì´ Mutexë¥¼ í•´ì œí•  ìˆ˜ ìˆë‹¤. í•˜ì§€ë§Œ, SemaphoreëŠ” ì†Œìœ í•˜ì§€ í•˜ì§€ ì•ŠëŠ” ì“°ë ˆë“œê°€ Semaphoreë¥¼ í•´ì œí•  ìˆ˜ ìˆë‹¤.





#### Q. ë™ê¸°í™” ê°ì²´ì˜ ì¢…ë¥˜ì™€ íŠ¹ì§•

**í¬ë¦¬í‹°ì»¬ ì„¹ì…˜ (CriticalSection)** -> ì‚¬ìš©ì ëª¨ë“œ ë™ê¸°í™” ê°ì²´

- ë‚´ë¶€ êµ¬ì¡°ê°€ ë‹¨ìˆœí•˜ê¸° ë•Œë¬¸ì— ë™ê¸°í™” ì²˜ë¦¬ë¥¼ í•˜ëŠ” ë° ìˆì–´ì„œ ì†ë„ê°€ ë¹ ë¥´ë‹¤.
- ë™ì¼í•œ í”„ë¡œì„¸ìŠ¤ ë‚´ì—ì„œë§Œ ë™ê¸°í™” ê°€ëŠ¥.
- ì»¤ë„ ê°ì²´ë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤.

**ë®¤í…ìŠ¤ (Mutex)** -> ì»¤ë„ ê°ì²´

- í”„ë¡œì„¸ìŠ¤ ë‹¤ì¤‘ ì‹¤í–‰ì„ ë§‰ì„ ë•Œ ì‚¬ìš©

**ì„¸ë§ˆí¬ì–´(Semaphore)** -> ì»¤ë„ ê°ì²´

- ì§€ì •ëœ ìˆ˜ë§Œí¼ì˜ ì“°ë ˆë“œê°€ ë™ì‹œì— ì‹¤í–‰ë˜ë„ë¡ ë™ê¸°í™” í•˜ëŠ” ê²ƒì´ ê°€ëŠ¥.



#### Q. ë°ë“œë½(DeadLock)ì´ë€?

A. ë°ë“œë½ì€ í”„ë¡œì„¸ìŠ¤ê°€ ìì›ì„ ì–»ì§€ ëª»í•´ì„œ ë‹¤ìŒ ì¼ì„ ì²˜ë¦¬í•˜ì§€ ëª»í•˜ëŠ” ìƒíƒœ. ì¦‰, êµì°© ìƒíƒœ. ë³´í†µ ì‹œìŠ¤í…œì ìœ¼ë¡œ í•œì •ëœ ìì›ì„ ì—¬ëŸ¬ ê³³ì—ì„œ ë™ì‹œì— ì‚¬ìš©í•˜ë ¤ê³  í•  ë•Œ ë°œìƒí•œë‹¤.

 

ì˜ˆë¥¼ ë“¤ì–´,

í”„ë¡œì„¸ìŠ¤ 1ì´ ë¦¬ì†ŒìŠ¤ 1ì„ ì‚¬ìš©í•˜ê³  ìˆê³ , ë¦¬ì†ŒìŠ¤ 2ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ ìš”ì²­í–ˆìœ¼ë©°

í”„ë¡œì„¸ìŠ¤ 2ê°€ ë¦¬ì†ŒìŠ¤ 1ì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ ìš”ì²­í–ˆê³ , ë¦¬ì†ŒìŠ¤ 2ë¥¼ ì‚¬ìš©í•˜ê³  ìˆë‹¤ë©´

í”„ë¡œì„¸ìŠ¤ 1 -> ë¦¬ì†ŒìŠ¤ 1(ì‚¬ìš© - Lock) / ë¦¬ì†ŒìŠ¤ 2(ìš”ì²­ - Wait)

í”„ë¡œì„¸ìŠ¤ 2 -> ë¦¬ì†ŒìŠ¤ 1(ìš”ì²­ - Wait) / ë¦¬ì†ŒìŠ¤ 2(ì‚¬ìš© - Lock)

ìƒíƒœê°€ ë˜ì„œ í”„ë¡œì„¸ìŠ¤ 1, 2 ëª¨ë‘ ë‹¤ìŒ ë¦¬ì†ŒìŠ¤ë¥¼ ì–»ì§€ ëª»í•´ ë©ˆì¶”ê²Œ ëœë‹¤.



#### Q. ë°ë“œë½(DeadLock)ì˜ ë°œìƒ ì¡°ê±´ 4ê°€ì§€

A. ì£¼ë¡œ ë©€í‹°í”„ë¡œê·¸ë˜ë° í™˜ê²½ì—ì„œ í•œì •ëœ ìì›ì„ ë†“ê³  ì„œë¡œ ê²½ìŸí•  ë•Œ ë°œìƒí•œë‹¤. 

ë°ë“œë½ì€ **4ê°€ì§€ ì¡°ê±´ì„ ëª¨ë‘ ë§Œì¡±í•´ì•¼ ë°œìƒí•  ìˆ˜ ìˆë‹¤.**

1. ìƒí˜¸ë°°ì œ (Mutual Exclusion): **ìì›ì€ í•œ ë²ˆì— í•œ í”„ë¡œì„¸ìŠ¤ë§Œ ì‚¬ìš© ê°€ëŠ¥í•˜ë‹¤.**
2. ì ìœ  ëŒ€ê¸° (Hold and Wait): **ìµœì†Œí•œ í•˜ë‚˜ì˜ ìì›ì„ ì ìœ (Lock)**í•˜ê³  ìˆìœ¼ë©´ì„œ **ë‹¤ë¥¸ í”„ë¡œì„¸ìŠ¤ì— í• ë‹¹ë˜ì–´ ì‚¬ìš©ë˜ê³  ìˆëŠ” ìì›ì„ ì¶”ê°€ë¡œ ì ìœ í•˜ê¸° ìœ„í•´ ëŒ€ê¸°(Wait)**
3. ë¹„ì„ ì  (No preemption): ë‹¤ë¥¸ í”„ë¡œì„¸ìŠ¤ì— í• ë‹¹ëœ ìì›ì€ í•´ë‹¹ í”„ë¡œì„¸ìŠ¤ê°€ ì‚¬ìš©ì´ ëë‚  ë•Œê¹Œì§€ **ê°•ì œë¡œ ë¹¼ì•—ì„ ìˆ˜ ì—†ë‹¤.**
4. ìˆœí™˜ ëŒ€ê¸°(Circular Wait): í”„ë¡œì„¸ìŠ¤ì˜ ì§‘í•©ì—ì„œ **ìˆœí™˜ í˜•íƒœ(ì‚¬ì´í´)ë¡œ ìì›ì„ ëŒ€ê¸°(Wait)**í•œë‹¤.



#### Q. ë°ë“œë½(DeadLock) ì²˜ë¦¬ ë°©ë²• 4ê°€ì§€

A. ì˜ˆë°©, íšŒí”¼, íƒì§€ ë° íšŒë³µ, ë¬´ì‹œ

1. ì˜ˆë°©(Prevention): ë°ë“œë½ ë°œìƒ ì¡°ê±´ ì¤‘ í•˜ë‚˜ë¥¼ ì œê±°í•˜ë©´ì„œ í•´ê²°
2. íšŒí”¼(Avoidance): ë°ë“œë½ì´ ë°œìƒí•  ì‹œ í”¼í•´ê°€ëŠ” ë°©ë²•. ëŒ€í‘œì ìœ¼ë¡œ **ì€í–‰ì› ì•Œê³ ë¦¬ì¦˜**
3. íƒì§€ ë° íšŒë³µ(Detection & Recovery): **ìì›í•  ë‹¹ ê·¸ë˜í”„ë¥¼ í†µí•´ ë°ë“œë½ ê°ì§€**, ë§Œì•½ ê°ì§€í•  ê²½ìš° **ì´ì „ ìƒíƒœë¡œ íšŒë³µ**
4. ë¬´ì‹œ(Ignore): ë°ë“œë½ ë°œìƒì„ ë¬´ì‹œí•˜ê³  ì§€ë‚˜ê°.



#### Q.  ì€í–‰ì› ì•Œê³ ë¦¬ì¦˜ (Banker Algorithm)

A. ë°ë“œë½ì„ ì²˜ë¦¬í•˜ê¸° ìœ„í•œ ë°©ë²• ì¤‘ **íšŒí”¼ì— í•´ë‹¹**í•˜ëŠ” ì•Œê³ ë¦¬ì¦˜. ë°ë“œë½ì— ë¹ ì§ˆ ìˆ˜ ìˆëŠ” ìƒíƒœë¥¼ ë¶ˆì•ˆì „ ìƒíƒœ, ë°ë“œë½ì— ë¹ ì§ˆ ìˆ˜ ì—†ëŠ” ìƒíƒœë¥¼ ì•ˆì „ ìƒíƒœë¼ê³  ê°€ì •í–ˆì„ ë•Œ, ìš´ì˜ì²´ì œëŠ” ì•ˆì „ ìƒíƒœì¼ ê²½ìš°ì—ë§Œ ìš”ì²­ì„ í—ˆë½í•˜ì—¬ ìì›ì„ í• ë‹¹í•´ì£¼ê³ , ë‚˜ë¨¸ì§€ ìš”êµ¬ë“¤ì€ ì•ˆì „ ìƒíƒœê°€ ë  ë•Œê¹Œì§€ ê³„ì† ê±°ì ˆí•˜ëŠ” ì•Œê³ ë¦¬ì¦˜



ì¦‰, **ìµœì†Œí•œ í•œ ëª…ì—ê²Œ ëŒ€ì¶œí•´ì¤„ ìˆ˜ ìˆëŠ” ëˆì€ ê°€ì§€ê³  ìˆì–´ì•¼ í•œë‹¤.** **ìš´ì˜ì²´ì œê°€ ìµœì†Œí•œ í•˜ë‚˜ì˜ í”„ë¡œì„¸ìŠ¤ê°€ ì¼ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ” ê²½ìš°ì—ë§Œ ìš”ì²­ì„ í—ˆë½í•˜ì—¬ ì‹œìŠ¤í…œì˜ ìì›ì„ í• ë‹¹í•´ì¤€ë‹¤.**

